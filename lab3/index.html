<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Обратная задача</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div><label for='n'>Количество отраслей </label><input id='n' value='3'/></div>

<input type='button' value='Ввести данные' onclick='build();'/>
<input type='button' value='Построить решение' onclick='calc();'/>
<input type='button' value='Построить решение прогнозного года' onclick='calcForecastYear();'/>
<input type='button' value='Очистить' onclick='cl();'/>

<div id='data'></div>
<div id='mobBasicYear'></div>
<div id='mobForecastYear'></div>

<script src="../jquery.min.js"></script>
<script src="../math.js"></script>
<script src="../mob.js"></script>
<script src="../sylvester.src.js"></script>

<script>
    var n, $data = $('#data'), $mobBasicYear = $('#mobBasicYear'), $mobForecastYear = $('#mobForecastYear');

    function build() {
        cl();
        n = parseInt($('#n').val(), 10);
        $data.append('<h2>Матрица прямых затрат</h2>');
        $data.append(getTable(n, n, 'A'));
        $data.append('<h2>Вектор конечных выпусков</h2>');
        $data.append(getTable(n, 1, 'Y'));
        $data.append('<h2>Прогноз</h2>');
        $data.append(getTable(n, 1, 'alpha'));
    }

    function getMobByY(Y, id) {
        var i, j, eDivA = [];

        for (i = 0; i < n; i++) {
            eDivA[i] = [];

            for (j = 0; j < n; j++) {
                eDivA[i][j] = (i === j ? 1 : 0) - getFloatValue('A', i, j);
            }
        }

        var inverseOfEDivA = Matrix.create(eDivA).inverse(), X = [];
        for (i = 0; i < n; i++) {
            X[i] = 0;
            for (j = 0; j < n; j++) {
                X[i] += inverseOfEDivA.e(i + 1, j + 1) * Y[j];
                console.log(inverseOfEDivA.e(i + 1, j + 1));
            }
        }

        return new MOB(n, 'A', X, Y, id);
    }

    function calc() {
        $mobBasicYear.empty();
        n = parseInt($('#n').val(), 10);

        var Y = [], i;
        for (i = 0; i < n; i++) {
            Y[i] = getFloatValue('Y', i, 0);
        }
        var mob = getMobByY(Y, 'mobBasicYear');
        $mobBasicYear.append(mob.getTable());
    }

    function calcForecastYear() {
        $mobForecastYear.empty();
        n = parseInt($('#n').val(), 10);

        var Y = [], i;
        for (i = 0; i < n; i++) {
            Y[i] = getFloatValue('Y', i, 0) * getFloatValue('alpha', i, 0);
        }
        var mob = getMobByY(Y, 'mobForecastYear');
        $mobForecastYear.append(mob.getTable());
    }


    function cl() {
        $data.empty();
        $mobBasicYear.empty();
        $mobForecastYear.empty();
    }
</script>

</body>
</html>